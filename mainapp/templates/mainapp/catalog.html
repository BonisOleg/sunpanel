{% extends 'mainapp/base.html' %}
{% load static %}

{% block title %}{{ title }}{% endblock %}
{% block description %}{{ description }}{% endblock %}
{% block keywords %}{{ keywords }}{% endblock %}
{% block canonical %}https://greensolartech.com.ua/catalog/{% endblock %}

{% block page_css %}
<link rel="stylesheet" href="{% static 'css/catalog.css' %}?v=2025012504">
{% endblock %}

{% block content %}
<div class="catalog-page">
    <div class="catalog-container">
        <div class="catalog-layout">
            <!-- –§—ñ–ª—å—Ç—Ä–∏ –ª—ñ–≤–æ—Ä—É—á -->
            <aside class="catalog-sidebar">
                <div class="filters-container">
                    <h3 class="filters-title">–§—ñ–ª—å—Ç—Ä–∏</h3>

                    <form class="filters-form" method="get" id="filters-form">
                        <!-- –§—ñ–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó -->
                        <div class="filter-group">
                            <label class="filter-label">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label>
                            <select name="category" class="filter-select">
                                <option value="">–í—Å—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</option>
                                {% for category in categories %}
                                <option value="{{ category }}" {% if selected_category == category %}selected{% endif %}>
                                    {{ category }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>

                        <!-- –§—ñ–ª—å—Ç—Ä –ø–æ –≤–∏—Ä–æ–±–Ω–∏–∫—É -->
                        <div class="filter-group">
                            <label class="filter-label">–í–∏—Ä–æ–±–Ω–∏–∫</label>
                            <select name="brand" class="filter-select">
                                <option value="">–í—Å—ñ –≤–∏—Ä–æ–±–Ω–∏–∫–∏</option>
                                {% for brand in brands %}
                                <option value="{{ brand }}" {% if selected_brand == brand %}selected{% endif %}>
                                    {{ brand }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="filters-actions">
                            <button type="submit" class="btn btn-primary filter-btn">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
                            <a href="{% url 'mainapp:catalog' %}" class="btn filter-btn filter-btn--clear">–û—á–∏—Å—Ç–∏—Ç–∏</a>
                        </div>
                    </form>
                </div>
            </aside>

            <!-- –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
            <main class="catalog-main">
                <div class="catalog-header">
                    <h1 class="catalog-title">{{ title }}</h1>
                    <div class="catalog-controls">
                        <select class="catalog-sort" name="sort">
                            <option value="">–°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è</option>
                            <option value="price_asc">–¶—ñ–Ω–∞: –∑–∞ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—è–º</option>
                            <option value="price_desc">–¶—ñ–Ω–∞: –∑–∞ —Å–ø–∞–¥–∞–Ω–Ω—è–º</option>
                            <option value="name_asc">–ù–∞–∑–≤–∞: –ê-–Ø</option>
                            <option value="name_desc">–ù–∞–∑–≤–∞: –Ø-–ê</option>
                        </select>
                        <div class="catalog-view-toggle">
                            <button class="view-toggle-btn active" data-view="grid">‚äû</button>
                            <button class="view-toggle-btn" data-view="list">‚ò∞</button>
                        </div>
                    </div>
                </div>

                <!-- 4 –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ñ –±–ª–æ–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π —è–∫ –Ω–∞ —Å–∫—Ä—ñ–Ω—à–æ—Ç–∞—Ö -->

                <!-- ‚ö° –Ü–Ω–≤–µ—Ä—Ç–æ—Ä–∏ -->
                {% if inverters %}
                <div class="category-section">
                    <div class="category-header">
                        <h2 class="category-title">‚ö° –Ü–Ω–≤–µ—Ä—Ç–æ—Ä–∏</h2>
                        <a href="{% url 'mainapp:category' 'inverters' %}" class="category-view-all">–î–∏–≤–∏—Ç–∏—Å—è –≤—Å—ñ</a>
                    </div>
                    <div class="products-horizontal-scroll">
                        {% for product in inverters %}
                        <div class="product-card">
                            <div class="product-card__image-container">
                                <img src="{{ product.static_image_url }}" alt="{{ product.name }}" class="product-card__image">
                                {% if product.featured %}
                                <span class="product-card__badge">–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ</span>
                                {% endif %}
                            </div>
                            <div class="product-card__content">
                                <h3 class="product-card__title">{{ product.name }}</h3>
                                <div class="product-card__brand">{{ product.brand.name }}</div>
                                <div class="product-card__price">‚Ç¥{{ product.price|floatformat:0 }}</div>
                                <button class="product-card__btn add-to-cart-btn" data-product-id="{{ product.id }}"
                                    data-product-name="{{ product.name }}" data-product-price="{{ product.price }}"
                                    data-product-image="{{ product.static_image_url }}">
                                    –î–æ–¥–∞—Ç–∏ –≤ –∫–æ—à–∏–∫
                                </button>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <!-- ‚òÄÔ∏è –°–æ–Ω—è—á–Ω—ñ –ø–∞–Ω–µ–ª—ñ -->
                {% if solar_panels %}
                <div class="category-section">
                    <div class="category-header">
                        <h2 class="category-title">‚òÄÔ∏è –°–æ–Ω—è—á–Ω—ñ –ø–∞–Ω–µ–ª—ñ</h2>
                        <a href="{% url 'mainapp:category' 'solar-panels' %}" class="category-view-all">–î–∏–≤–∏—Ç–∏—Å—è –≤—Å—ñ</a>
                    </div>
                    <div class="products-horizontal-scroll">
                        {% for product in solar_panels %}
                        <div class="product-card">
                            <div class="product-card__image-container">
                                <img src="{{ product.static_image_url }}" alt="{{ product.name }}" class="product-card__image">
                                {% if product.featured %}
                                <span class="product-card__badge">–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ</span>
                                {% endif %}
                            </div>
                            <div class="product-card__content">
                                <h3 class="product-card__title">{{ product.name }}</h3>
                                <div class="product-card__brand">{{ product.brand.name }}</div>
                                <div class="product-card__price">‚Ç¥{{ product.price|floatformat:0 }}</div>
                                <button class="product-card__btn add-to-cart-btn" data-product-id="{{ product.id }}"
                                    data-product-name="{{ product.name }}" data-product-price="{{ product.price }}"
                                    data-product-image="{{ product.static_image_url }}">
                                    –î–æ–¥–∞—Ç–∏ –≤ –∫–æ—à–∏–∫
                                </button>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <!-- üîã –ê–∫—É–º—É–ª—è—Ç–æ—Ä–Ω—ñ –±–∞—Ç–∞—Ä–µ—ó -->
                {% if batteries %}
                <div class="category-section">
                    <div class="category-header">
                        <h2 class="category-title">üîã –ê–∫—É–º—É–ª—è—Ç–æ—Ä–Ω—ñ –±–∞—Ç–∞—Ä–µ—ó</h2>
                        <a href="{% url 'mainapp:category' 'batteries' %}" class="category-view-all">–î–∏–≤–∏—Ç–∏—Å—è –≤—Å—ñ</a>
                    </div>
                    <div class="products-horizontal-scroll">
                        {% for product in batteries %}
                        <div class="product-card">
                            <div class="product-card__image-container">
                                <img src="{{ product.static_image_url }}" alt="{{ product.name }}" class="product-card__image">
                                {% if product.featured %}
                                <span class="product-card__badge">–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ</span>
                                {% endif %}
                            </div>
                            <div class="product-card__content">
                                <h3 class="product-card__title">{{ product.name }}</h3>
                                <div class="product-card__brand">{{ product.brand.name }}</div>
                                <div class="product-card__price">‚Ç¥{{ product.price|floatformat:0 }}</div>
                                <button class="product-card__btn add-to-cart-btn" data-product-id="{{ product.id }}"
                                    data-product-name="{{ product.name }}" data-product-price="{{ product.price }}"
                                    data-product-image="{{ product.static_image_url }}">
                                    –î–æ–¥–∞—Ç–∏ –≤ –∫–æ—à–∏–∫
                                </button>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <!-- üì¶ –ö–æ–º–ø–ª–µ–∫—Ç–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∂–∏–≤–ª–µ–Ω–Ω—è -->
                {% if backup_kits %}
                <div class="category-section">
                    <div class="category-header">
                        <h2 class="category-title">üì¶ –ö–æ–º–ø–ª–µ–∫—Ç–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∂–∏–≤–ª–µ–Ω–Ω—è</h2>
                        <a href="{% url 'mainapp:category' 'backup-power' %}" class="category-view-all">–î–∏–≤–∏—Ç–∏—Å—è –≤—Å—ñ</a>
                    </div>
                    <div class="products-horizontal-scroll">
                        {% for product in backup_kits %}
                        <div class="product-card">
                            <div class="product-card__image-container">
                                <img src="{{ product.static_image_url }}" alt="{{ product.name }}" class="product-card__image">
                                {% if product.featured %}
                                <span class="product-card__badge">–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ</span>
                                {% endif %}
                            </div>
                            <div class="product-card__content">
                                <h3 class="product-card__title">{{ product.name }}</h3>
                                <div class="product-card__brand">{{ product.brand.name }}</div>
                                <div class="product-card__price">‚Ç¥{{ product.price|floatformat:0 }}</div>
                                <button class="product-card__btn add-to-cart-btn" data-product-id="{{ product.id }}"
                                    data-product-name="{{ product.name }}" data-product-price="{{ product.price }}"
                                    data-product-image="{{ product.static_image_url }}">
                                    –î–æ–¥–∞—Ç–∏ –≤ –∫–æ—à–∏–∫
                                </button>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <!-- –Ø–∫—â–æ —Ç–æ–≤–∞—Ä—ñ–≤ –Ω–µ–º–∞—î -->
                {% if not inverters and not solar_panels and not batteries and not backup_kits %}
                <div class="catalog-empty">
                    <div class="catalog-empty__icon">üì¶</div>
                    <h3 class="catalog-empty__title">–¢–æ–≤–∞—Ä–∏ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</h3>
                    <p class="catalog-empty__text">–°–ø—Ä–æ–±—É–π—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏ –∞–±–æ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –ø—ñ–∑–Ω—ñ—à–µ</p>
                    <a href="{% url 'mainapp:catalog' %}" class="btn btn-primary">–°–∫–∏–Ω—É—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏</a>
                </div>
                {% endif %}

                <!-- –ü–∞–≥—ñ–Ω–∞—Ü—ñ—è -->
                {% if is_paginated %}
                <div class="pagination">
                    {% if page_obj.has_previous %}
                    <a href="?page=1" class="pagination__item">¬´ –ü–µ—Ä—à–∞</a>
                    <a href="?page={{ page_obj.previous_page_number }}" class="pagination__item">‚Äπ –ü–æ–ø–µ—Ä–µ–¥–Ω—è</a>
                    {% endif %}

                    {% for num in page_obj.paginator.page_range %}
                    {% if page_obj.number == num %}
                    <span class="pagination__item pagination__item--active">{{ num }}</span>
                    {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %} <a
                        href="?page={{ num }}" class="pagination__item">{{ num }}</a>
                        {% endif %}
                        {% endfor %}

                        {% if page_obj.has_next %}
                        <a href="?page={{ page_obj.next_page_number }}" class="pagination__item">–ù–∞—Å—Ç—É–ø–Ω–∞ ‚Ä∫</a>
                        <a href="?page={{ page_obj.paginator.num_pages }}" class="pagination__item">–û—Å—Ç–∞–Ω–Ω—è ¬ª</a>
                        {% endif %}
                </div>
                {% endif %}
            </main>
        </div>
    </div>
</div>
{% endblock %}

{% block page_js %}
<script src="{% static 'js/catalog.js' %}?v=2025012504"></script>
{% endblock %}