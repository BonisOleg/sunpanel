{% extends 'mainapp/base.html' %}
{% load static %}

{% block title %}{{ title }}{% endblock %}
{% block description %}{{ description }}{% endblock %}
{% block keywords %}{{ keywords }}{% endblock %}
{% block canonical %}https://greensolalrtech.com/catalog/{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/catalog.css' %}">
{% endblock %}

{% block content %}
<div class="catalog-page">
    <div class="catalog-container">
        <header class="catalog-header">
            <h1 class="catalog-title">–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä—ñ–≤</h1>
            <p class="catalog-subtitle">–û–±–ª–∞–¥–Ω–∞–Ω–Ω—è –¥–ª—è —Å–æ–Ω—è—á–Ω–∏—Ö –µ–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞–Ω—Ü—ñ–π –≤—ñ–¥ –ø—Ä–æ–≤—ñ–¥–Ω–∏—Ö –≤–∏—Ä–æ–±–Ω–∏–∫—ñ–≤</p>
        </header>

        <div class="catalog-layout">
            <!-- –§—ñ–ª—å—Ç—Ä–∏ –ª—ñ–≤–æ—Ä—É—á (20%) -->
            <aside class="catalog-sidebar">
                <div class="filters-container">
                    <h3 class="filters-title">–§—ñ–ª—å—Ç—Ä–∏</h3>

                    <form class="filters-form" method="get" id="filters-form">
                        <!-- –§—ñ–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó -->
                        <div class="filter-group">
                            <label class="filter-label">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label>
                            <select name="category" class="filter-select">
                                <option value="">–í—Å—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</option>
                                {% for category in categories %}
                                <option value="{{ category }}" {% if selected_category == category %}selected{% endif %}>
                                    {{ category }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>

                        <!-- –§—ñ–ª—å—Ç—Ä –ø–æ –≤–∏—Ä–æ–±–Ω–∏–∫—É -->
                        <div class="filter-group">
                            <label class="filter-label">–í–∏—Ä–æ–±–Ω–∏–∫</label>
                            <select name="brand" class="filter-select">
                                <option value="">–í—Å—ñ –≤–∏—Ä–æ–±–Ω–∏–∫–∏</option>
                                {% for brand in brands %}
                                <option value="{{ brand }}" {% if selected_brand == brand %}selected{% endif %}>
                                    {{ brand }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>

                        <!-- –§—ñ–ª—å—Ç—Ä –ø–æ —Ü—ñ–Ω—ñ -->
                        <div class="filter-group">
                            <label class="filter-label">–¶—ñ–Ω–∞</label>
                            <div class="price-range">
                                <input type="number" name="price_min" placeholder="–í—ñ–¥" value="{{ price_min }}"
                                    class="price-input">
                                <span class="price-separator">-</span>
                                <input type="number" name="price_max" placeholder="–î–æ" value="{{ price_max }}"
                                    class="price-input">
                            </div>
                        </div>

                        <button type="submit" class="filters-btn">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏</button>
                        <a href="{% url 'mainapp:catalog' %}" class="filters-reset">–°–∫–∏–Ω—É—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏</a>
                    </form>
                </div>
            </aside>

            <!-- –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç –ø—Ä–∞–≤–æ—Ä—É—á (80%) -->
            <div class="catalog-content">
                <!-- –Ü–Ω–≤–µ—Ä—Ç–æ—Ä–∏ -->
                {% if inverters %}
                <div class="category-section">
                    <div class="category-header">
                        <h2 class="category-title">‚ö° –Ü–Ω–≤–µ—Ä—Ç–æ—Ä–∏</h2>
                        <a href="{% url 'mainapp:category' 'inverters' %}" class="view-all-btn">–î–∏–≤–∏—Ç–∏—Å—è –≤—Å—ñ</a>
                    </div>
                    <div class="products-carousel" data-category="inverters">
                        <div class="carousel-container">
                            <div class="carousel-track">
                                {% for product in inverters %}
                                <div class="product-card">
                                    {% if product.image %}
                                    <div class="product-image">
                                        <img src="{{ product.image.url }}" alt="{{ product.name }}">
                                    </div>
                                    {% endif %}
                                    <div class="product-info">
                                        <h3 class="product-name">{{ product.name }}</h3>
                                        <p class="product-brand">{{ product.brand }}</p>
                                        <p class="product-price">‚Ç¥{{ product.price|floatformat:0 }}</p>
                                        <button class="add-to-cart-btn" data-id="{{ product.id }}"
                                            data-name="{{ product.name }}" data-price="{{ product.price }}"
                                            data-image="{% if product.image %}{{ product.image.url }}{% endif %}">
                                            –î–æ–¥–∞—Ç–∏ –≤ –∫–æ—à–∏–∫
                                        </button>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        <button class="carousel-btn carousel-prev" data-direction="prev">‚Äπ</button>
                        <button class="carousel-btn carousel-next" data-direction="next">‚Ä∫</button>
                    </div>
                </div>
                {% endif %}

                <!-- –°–æ–Ω—è—á–Ω—ñ –ø–∞–Ω–µ–ª—ñ -->
                {% if solar_panels %}
                <div class="category-section">
                    <div class="category-header">
                        <h2 class="category-title">‚òÄÔ∏è –°–æ–Ω—è—á–Ω—ñ –ø–∞–Ω–µ–ª—ñ</h2>
                        <a href="{% url 'mainapp:category' 'solar-panels' %}" class="view-all-btn">–î–∏–≤–∏—Ç–∏—Å—è –≤—Å—ñ</a>
                    </div>
                    <div class="products-carousel" data-category="solar-panels">
                        <div class="carousel-container">
                            <div class="carousel-track">
                                {% for product in solar_panels %}
                                <div class="product-card">
                                    {% if product.image %}
                                    <div class="product-image">
                                        <img src="{{ product.image.url }}" alt="{{ product.name }}">
                                    </div>
                                    {% endif %}
                                    <div class="product-info">
                                        <h3 class="product-name">{{ product.name }}</h3>
                                        <p class="product-brand">{{ product.brand }}</p>
                                        <p class="product-price">‚Ç¥{{ product.price|floatformat:0 }}</p>
                                        <button class="add-to-cart-btn" data-id="{{ product.id }}"
                                            data-name="{{ product.name }}" data-price="{{ product.price }}"
                                            data-image="{% if product.image %}{{ product.image.url }}{% endif %}">
                                            –î–æ–¥–∞—Ç–∏ –≤ –∫–æ—à–∏–∫
                                        </button>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        <button class="carousel-btn carousel-prev" data-direction="prev">‚Äπ</button>
                        <button class="carousel-btn carousel-next" data-direction="next">‚Ä∫</button>
                    </div>
                </div>
                {% endif %}

                <!-- –ê–∫—É–º—É–ª—è—Ç–æ—Ä–∏ -->
                {% if batteries %}
                <div class="category-section">
                    <div class="category-header">
                        <h2 class="category-title">üîã –ê–∫—É–º—É–ª—è—Ç–æ—Ä–∏</h2>
                        <a href="{% url 'mainapp:category' 'batteries' %}" class="view-all-btn">–î–∏–≤–∏—Ç–∏—Å—è –≤—Å—ñ</a>
                    </div>
                    <div class="products-carousel" data-category="batteries">
                        <div class="carousel-container">
                            <div class="carousel-track">
                                {% for product in batteries %}
                                <div class="product-card">
                                    {% if product.image %}
                                    <div class="product-image">
                                        <img src="{{ product.image.url }}" alt="{{ product.name }}">
                                    </div>
                                    {% endif %}
                                    <div class="product-info">
                                        <h3 class="product-name">{{ product.name }}</h3>
                                        <p class="product-brand">{{ product.brand }}</p>
                                        <p class="product-price">‚Ç¥{{ product.price|floatformat:0 }}</p>
                                        <button class="add-to-cart-btn" data-id="{{ product.id }}"
                                            data-name="{{ product.name }}" data-price="{{ product.price }}"
                                            data-image="{% if product.image %}{{ product.image.url }}{% endif %}">
                                            –î–æ–¥–∞—Ç–∏ –≤ –∫–æ—à–∏–∫
                                        </button>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        <button class="carousel-btn carousel-prev" data-direction="prev">‚Äπ</button>
                        <button class="carousel-btn carousel-next" data-direction="next">‚Ä∫</button>
                    </div>
                </div>
                {% endif %}

                <!-- –ö–æ–º–ø–ª–µ–∫—Ç–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∂–∏–≤–ª–µ–Ω–Ω—è -->
                {% if backup_kits %}
                <div class="category-section">
                    <div class="category-header">
                        <h2 class="category-title">üì¶ –ö–æ–º–ø–ª–µ–∫—Ç–∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∂–∏–≤–ª–µ–Ω–Ω—è</h2>
                        <a href="{% url 'mainapp:category' 'backup-power' %}" class="view-all-btn">–î–∏–≤–∏—Ç–∏—Å—è –≤—Å—ñ</a>
                    </div>
                    <div class="products-carousel" data-category="backup-power">
                        <div class="carousel-container">
                            <div class="carousel-track">
                                {% for product in backup_kits %}
                                <div class="product-card">
                                    {% if product.image %}
                                    <div class="product-image">
                                        <img src="{{ product.image.url }}" alt="{{ product.name }}">
                                    </div>
                                    {% endif %}
                                    <div class="product-info">
                                        <h3 class="product-name">{{ product.name }}</h3>
                                        <p class="product-brand">{{ product.brand }}</p>
                                        <p class="product-price">‚Ç¥{{ product.price|floatformat:0 }}</p>
                                        <button class="add-to-cart-btn" data-id="{{ product.id }}"
                                            data-name="{{ product.name }}" data-price="{{ product.price }}"
                                            data-image="{% if product.image %}{{ product.image.url }}{% endif %}">
                                            –î–æ–¥–∞—Ç–∏ –≤ –∫–æ—à–∏–∫
                                        </button>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        <button class="carousel-btn carousel-prev" data-direction="prev">‚Äπ</button>
                        <button class="carousel-btn carousel-next" data-direction="next">‚Ä∫</button>
                    </div>
                </div>
                {% endif %}

                {% if not inverters and not solar_panels and not batteries and not backup_kits %}
                <div class="no-products">
                    <p>–ó–∞ –≤–∞—à–∏–º–∏ –∫—Ä–∏—Ç–µ—Ä—ñ—è–º–∏ —Ç–æ–≤–∞—Ä–∏ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.</p>
                    <a href="{% url 'mainapp:catalog' %}" class="reset-filters-btn">–°–∫–∏–Ω—É—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏</a>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/catalog-carousel.js' %}"></script>
{% endblock %}