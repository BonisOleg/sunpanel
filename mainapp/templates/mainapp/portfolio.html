{% extends 'mainapp/base.html' %}
{% load static %}

{% block title %}{{ title }}{% endblock %}
{% block description %}{{ description }}{% endblock %}
{% block keywords %}{{ keywords }}{% endblock %}
{% block canonical %}https://greensolalrtech.com/portfolio/{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/portfolio.css' %}?v=2">
{% endblock %}

{% block content %}
<div class="portfolio-page">
    <div class="portfolio-container">
        <header class="portfolio-header">
            <h1 class="portfolio-title">Портфоліо проєктів</h1>
            <p class="portfolio-subtitle">Реалізовані сонячні електростанції по всій Україні</p>
        </header>

        <!-- Проект 1: Комерційна СЕС -->
        <section class="project-block">
            <div class="project-header">
                <h2 class="project-title">{{ project1.title }}</h2>
                <div class="project-meta-main">
                    <div class="meta-grid">
                        <div class="meta-item">
                            <span class="meta-label">Потужність:</span>
                            <span class="meta-value">{{ project1.power_capacity }} кВт</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Локація:</span>
                            <span class="meta-value">{{ project1.location }}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Тип проєкту:</span>
                            <span class="meta-value">{{ project1.project_type }}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Дата завершення:</span>
                            <span class="meta-value">{{ project1.completion_date|date:"j F Y" }}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Клієнт:</span>
                            <span class="meta-value">{{ project1.client_name }}</span>
                        </div>
                    </div>
                </div>
            </div>

            {% if project1.all_images %}
            <div class="project-gallery">
                <h3 class="gallery-title">Фотогалерея проекту</h3>
                <div class="gallery-grid">
                    {% for image in project1.all_images %}
                    <div class="gallery-item">
                        <img src="/media/{{ image }}" alt="{{ project1.title }}" loading="lazy">
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <div class="project-description">
                <h3 class="description-title">Опис проекту</h3>
                <div class="description-content">{{ project1.description|linebreaks }}</div>
            </div>
        </section>

        <!-- Проект 2: Промислова СЕС -->
        <section class="project-block">
            <div class="project-header">
                <h2 class="project-title">{{ project2.title }}</h2>
                <div class="project-meta-main">
                    <div class="meta-grid">
                        <div class="meta-item">
                            <span class="meta-label">Потужність:</span>
                            <span class="meta-value">{{ project2.power_capacity }} кВт</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Локація:</span>
                            <span class="meta-value">{{ project2.location }}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Тип проєкту:</span>
                            <span class="meta-value">{{ project2.project_type }}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Дата завершення:</span>
                            <span class="meta-value">{{ project2.completion_date|date:"j F Y" }}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Клієнт:</span>
                            <span class="meta-value">{{ project2.client_name }}</span>
                        </div>
                    </div>
                </div>
            </div>

            {% if project2.all_images %}
            <div class="project-gallery">
                <h3 class="gallery-title">Фотогалерея проекту</h3>
                <div class="gallery-grid">
                    {% for image in project2.all_images %}
                    <div class="gallery-item">
                        <img src="/media/{{ image }}" alt="{{ project2.title }}" loading="lazy">
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <div class="project-description">
                <h3 class="description-title">Опис проекту</h3>
                <div class="description-content">{{ project2.description|linebreaks }}</div>
            </div>
        </section>

        <!-- Проект 3: Приватна СЕС -->
        <section class="project-block">
            <div class="project-header">
                <h2 class="project-title">{{ project3.title }}</h2>
                <div class="project-meta-main">
                    <div class="meta-grid">
                        <div class="meta-item">
                            <span class="meta-label">Потужність:</span>
                            <span class="meta-value">{{ project3.power_capacity }} кВт</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Локація:</span>
                            <span class="meta-value">{{ project3.location }}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Тип проєкту:</span>
                            <span class="meta-value">{{ project3.project_type }}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Дата завершення:</span>
                            <span class="meta-value">{{ project3.completion_date|date:"j F Y" }}</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Клієнт:</span>
                            <span class="meta-value">{{ project3.client_name }}</span>
                        </div>
                    </div>
                </div>
            </div>

            {% if project3.all_images %}
            <div class="project-gallery">
                <h3 class="gallery-title">Фотогалерея проекту</h3>
                <div class="gallery-grid">
                    {% for image in project3.all_images %}
                    <div class="gallery-item">
                        <img src="/media/{{ image }}" alt="{{ project3.title }}" loading="lazy">
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <div class="project-description">
                <h3 class="description-title">Опис проекту</h3>
                <div class="description-content">{{ project3.description|linebreaks }}</div>
            </div>
        </section>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Анімація появи блоків при скролі
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver(function (entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);

    // Додаємо анімацію до всіх блоків проектів
    document.addEventListener('DOMContentLoaded', function () {
        document.querySelectorAll('.project-block').forEach(block => {
            block.style.opacity = '0';
            block.style.transform = 'translateY(30px)';
            block.style.transition = 'opacity 0.8s ease, transform 0.8s ease';
            observer.observe(block);
        });

        // Lightbox для галереї
        document.querySelectorAll('.gallery-item img').forEach(img => {
            img.addEventListener('click', function () {
                const lightbox = document.createElement('div');
                lightbox.className = 'lightbox';
                lightbox.innerHTML = `
                    <div class="lightbox-content">
                        <img src="${this.src}" alt="${this.alt}">
                        <button class="lightbox-close">&times;</button>
                    </div>
                `;
                document.body.appendChild(lightbox);
                document.body.style.overflow = 'hidden';

                lightbox.addEventListener('click', function (e) {
                    if (e.target === lightbox || e.target.classList.contains('lightbox-close')) {
                        document.body.removeChild(lightbox);
                        document.body.style.overflow = 'auto';
                    }
                });
            });
        });
    });
</script>

<style>
    /* Lightbox стилі */
    .lightbox {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        padding: 20px;
    }

    .lightbox-content {
        position: relative;
        max-width: 90%;
        max-height: 90%;
    }

    .lightbox-content img {
        width: 100%;
        height: auto;
        max-height: 80vh;
        object-fit: contain;
    }

    .lightbox-close {
        position: absolute;
        top: -40px;
        right: 0;
        background: none;
        border: none;
        color: white;
        font-size: 30px;
        cursor: pointer;
        width: 40px;
        height: 40px;
    }
</style>
{% endblock %}